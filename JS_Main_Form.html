<script>
  window.clearIt = function(thisEl) {
    document.getElementById('msgToUsr').style.display = 'none';
    thisEl.style.backgroundColor = "";
  };
  
  window.submitForm = function(myForm) {
    var key,value,requiredList=[],nameName,thisEl,errElmt,inputType,die;
    die = false;

    requiredList = ['name','birth','myFile1'];//This is a list of the names of questions that must be filled out

    for (key in myForm) {
      /*console.log('key: ' + key);
      console.log('value: ' + myForm[key]);
      
      console.log('value: ' + myForm[key].value);
      console.log(myForm[key].value === "");
  */
      thisEl = myForm[key];
      if (thisEl===null) continue;
      
      nameName = thisEl.name;
      if (requiredList.indexOf(nameName) === -1) {continue;};//If the name is not in the required list
      
      value = thisEl.value;
      inputType = thisEl.type;
      
      
      /*console.log('inputType: ' + inputType);
      console.log('value: ' + value);
      console.log('name: ' + nameName);
      
      console.log(value === "");
      */
      if (value === "") {
        //console.log('inside if block')
        //console.log(requiredList.indexOf(nameName) === -1);
        
        if (requiredList.indexOf(nameName) === -1) {continue;};//If the name is not in the required list
        die = true;
        //then it's not required, keep on checking other entries
        toggle_visibility('inProgress');
        toggle_visibility('formDiv');
        
        thisEl.style.backgroundColor = "red";//Turn the background red
        thisEl.focus();//Move focus to the element with missing data
        window.scrollTo(0,0);//Scroll to the top
        errElmt = document.getElementById('msgToUsr');
        errElmt.textContent = "Required Field is Empty!  click this message to close";
        errElmt.style.display = 'inline-block';
        errElmt.style.top = "45%";
        errElmt.addEventListener("click", function(){
          this.style.display = "none";});
      };
    };
    
    //console.log('right before google.script.run');
    //console.log(die);
    
    if (die) return; 

    toggle_visibility('formDiv');
    toggle_visibility('inProgress');
    AlanWells_shwSpnr('idSpnr');
    
    google.script.run
      .withSuccessHandler(updateOutput)
      .processForm(myForm)
  
  };

  // Javascript function called by "submit" button handler,
  // to show results.
  function updateOutput(dataReturned) {
    var html,outputDiv;
    
    console.log('dataReturned: ' + dataReturned);
    console.log('typeof dataReturned: ' + typeof dataReturned);

    if (typeof dataReturned === 'object') {
      html = "<div>Data was not saved to spreadsheet</div><div>No Spreadsheet ID is set</div>" + dataReturned[2];
    } else {
      html = dataReturned;
    };
    toggle_visibility('inProgress');
    outputDiv = document.getElementById('output');
    outputDiv.innerHTML = html;
    AlanWells_hideSpnr('idSpnr');
  }

  // From blog.movalog.com/a/javascript-toggle-visibility/
  function toggle_visibility(id) {
    var e;
    //console.log('toggle_visibility ran' + id);
    
    e = document.getElementById(id);
    if(e.style.display !== 'none')//Modified this line
      e.style.display = 'none';
    else
      e.style.display = 'block';
  }
  
  /* I modified the code for the function named toggle_visibility

    if(e.style.display !== 'none')//Modified this line
  
  Was:

    if(e.style.display === 'block')
    The style could be many different settings. If it's inline for example, then that would break the code.
    But if it's !== "none", then if it's anything but none, then it's obviously being displayed.
  */
</script>